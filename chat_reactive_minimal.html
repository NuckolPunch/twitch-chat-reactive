<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Chat Reactive Minimal</title>
<style>
  body {
    margin: 0;
    background: transparent;
    overflow: hidden;
  }
  #avatar {
    width: 100%;
    height: 100%;
  }
</style>
</head>
<body>
<img id="avatar" src="" alt="avatar" />

<script src="https://cdn.jsdelivr.net/npm/tmi.js@1.8.5"></script>
<script>
  const urlParams = new URLSearchParams(window.location.search);
  const channelName = urlParams.get('channel');
  const idleImg = urlParams.get('idle');
  const reactImg = urlParams.get('reacting');

  const avatar = document.getElementById('avatar');
  avatar.src = idleImg;

  let showingReact = false;

  function toggleReact() {
    avatar.src = showingReact ? idleImg : reactImg;
    showingReact = !showingReact;
  }

  function startConnection() {
    const client = new tmi.Client({ channels: [channelName] });
    client.connect().catch(() => setTimeout(startConnection, 5000));

    client.on('message', (_, __, message, self) => {
      if (self) return;
      toggleReact();
    });

    client.on('disconnected', () => {
      setTimeout(startConnection, 5000);
    });
  }

  startConnection();
</script>
</body>
</html>